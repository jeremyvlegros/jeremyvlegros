{%- comment -%} it does not check types nor strip spaces {%- endcomment -%}

{%- comment -%} initialization {%- endcomment -%}
{%- assign _this = include.this -%}
{%- assign _that = include.that -%}
{%- assign _with_warning = include.with_warning -%}
{%- assign _with_success = include.with_success -%}
{%- assign _with_name = include.with_name -%}
{%- comment -%}{%- assign _with_version = include.with_version -%}{%- endcomment -%}
{%- assign _with_version = "1689012860907734493" -%}
{%- assign _message = null -%}

{%- comment -%} dealing with empty strings {%- endcomment -%}

{%- if _with_warning == "" -%}
    {%- comment -%}resetting{%- endcomment -%}
    {%- assign _with_warning = null -%}
{%- endif -%}

{%- if _with_success == "" -%}
    {%- comment -%}resetting{%- endcomment -%}
    {%- assign _with_success = null -%}
{%- endif -%}

{%- if _with_name == "" -%}
    {%- comment -%}resetting{%- endcomment -%}
    {%- assign _with_name = null -%}
{%- endif -%}

{%- if _with_version == "" -%}
    {%- comment -%}resetting{%- endcomment -%}
    {%- assign _with_version = null -%}
{%- endif -%}

{%- comment -%} option with version{%- endcomment -%}
{%- if _with_version -%}
    {%- comment -%} formatting version => `version version_name ` >{%- endcomment -%}
    {%- assign _with_version = "version `" | append: _with_version | append: "` >" -%}
{%- endif -%}

{%- comment -%} option with test name{%- endcomment -%}
{%- if _with_name -%}
    {%- comment -%} formatting test name => test : `test_name` >{%- endcomment -%}
    {%- assign _with_name = "`" | append: _with_name | append: "` > " -%}
{%- endif -%}

{%- comment -%} option warnings {%- endcomment -%}
{%- if _with_warning -%}

    {%- comment -%} recycling `_with_warning` as string {%- endcomment -%}
    {%- assign _with_warning = "" -%}

    {%- comment -%} null == null {%- endcomment -%}
    {%- if _this == null and _that == null -%}
        {%- comment -%} warning contains a message {%- endcomment -%}
        {%- assign _with_warning = "> WARNING tested null values" -%}
    {%- endif -%}

    {%- comment -%} null == ""{%- endcomment -%}
    {%- if _this == null and _that == "" -%}
        {%- comment -%} warning contains a message {%- endcomment -%}
        {%- assign _with_warning = _with_warning | append: "> WARNING tested null value `this` and empty string `that`" -%}
    {%- endif -%}

    {%- comment -%} "" == null {%- endcomment -%}
    {%- if _this == "" and _that == null -%}
        {%- comment -%} warning contains a message {%- endcomment -%}
        {%- assign _with_warning = _with_warning | append: "> WARNING tested empty string `this` and null value `that`" -%}
    {%- endif -%}

{%- endif -%}

{%- comment -%} prettier print {%- endcomment -%}
{%- assign _this = _this | jsonify -%}
{%- assign _that = _that | jsonify -%}

{%- comment -%} failed test {%- endcomment -%}
{%- if _this != _that -%}

    {%- comment -%} fail message {%- endcomment -%}
    {%- capture _message -%}
        Failed test for {{ _with_name }} {{ _with_version }}`{{ _this }}` == `{{ _that }}`{{ _with_warning }}
    {%- endcapture -%}

    {%- comment -%} succesfull test {%- endcomment -%}
{%- else -%}
    {%- comment -%} option with success {%- endcomment -%}
    {%- if _with_success -%}

        {%- comment -%} succesfull message {%- endcomment -%}
        {%- capture _message -%}
            Successfull test for {{ _with_name }} {{ _with_version }}`{{ _this }}` == `{{ _that }}`{{ _with_warning }}
        {%- endcapture -%}

    {%- endif -%}
{%- endif -%}

{%- comment -%} printing the message {%- endcomment -%}
{{ _message }}


{%- comment -%} resetting the variables {%- endcomment -%}
{%- assign _this = null -%}
{%- assign _that = null -%}
{%- assign _with_warning = null -%}
{%- assign _with_success = null -%}
{%- assign _with_name = null -%}
{%- assign _with_version = null -%}
{%- assign _message = null -%}